<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (25) -->
<title>ThreadSafe (Error Prone parent POM 1.0-HEAD-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: com.google.errorprone.annotations, annotation type: ThreadSafe">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ThreadSafe.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../search.html">Search</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.google.errorprone.annotations</a></li>
<li><a href="ThreadSafe.html" class="current-selection">ThreadSafe</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Annotation Interface ThreadSafe" class="title">Annotation Interface ThreadSafe</h1>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/Target.html" title="class or interface in java.lang.annotation" class="external-link">@Target</a>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/ElementType.html#TYPE" title="class or interface in java.lang.annotation" class="external-link">TYPE</a>)
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/Retention.html" title="class or interface in java.lang.annotation" class="external-link">@Retention</a>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/RetentionPolicy.html#RUNTIME" title="class or interface in java.lang.annotation" class="external-link">RUNTIME</a>)
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/Inherited.html" title="class or interface in java.lang.annotation" class="external-link">@Inherited</a>
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/annotation/Documented.html" title="class or interface in java.lang.annotation" class="external-link">@Documented</a>
</span><span class="modifiers">public @interface </span><span class="element-name type-name-label">ThreadSafe</span></div>
<div class="block">This annotation indicates that the class/interface it is applied to is thread safe

<p>An object is thread safe if no sequences of accesses (like reads and writes to public fields
or calls to public methods) may put the object into an invalid state, or cause it to violate its
contract, regardless of the interleaving of those actions at runtime.

<p>This annotation has two related-but-distinct purposes:

<ul>
  <li>For humans: it indicates that the class/interface (and subclasses) is thread-safe
  <li>For machines: it causes the annotated class/interface -- and all of its subtypes -- to be
      validated by the <code>com.google.errorprone.bugpatterns.threadsafety.ThreadSafeChecker</code>
      <code>BugChecker</code>.
</ul>

Note that passing the checks performed by the <code>ThreadSafeChecker</code> is neither necessary nor
sufficient to guarantee the thread safety of a class. In fact, it is not possible to determine
thread safety through static code analysis alone, and the goal of <code>ThreadSafeChecker</code> is to
steer the code towards using standard thread-safe patterns, and then to assist the developer in
avoiding common mistakes. It is not meant as a substitute for diligent code review by a
knowledgeable developer.

<p>Also note that the only easy way to guarantee thread-safety of a class is to make it
immutable, and you should do that whenever possible (or at the least, make as much of the class
be immutable). Otherwise, writing a thread-safe class is inherently tricky and error prone, and
keeping it thread-safe is even more so.

<p>The remainder of this javadoc describes the heuristics enforced by <code>ThreadSafeChecker</code>
and the related <code>com.google.errorprone.bugpatterns.threadsafety.GuardedByChecker</code> and
<code>com.google.errorprone.bugpatterns.threadsafety.ImmutableChecker</code> on which the former
relies.

<p>The <code>ThreadSafeChecker</code> heuristics enforce that every field meets at least one of these
requirements:

<ul>
  <li>It is both <code>final</code> and its type is deemed inherently deeply thread-safe; and/or
  <li>it is annotated with either <a href="concurrent/GuardedBy.html" title="annotation interface in com.google.errorprone.annotations.concurrent"><code>GuardedBy</code></a>
      (some other annotations named <code>GuardedBy</code> also work, though this the preferred);
</ul>

Below, more details about what is meant by "deemed inherently deeply thread-safe" are presented,
and, afterwards, more about <code>GuardedBy</code>.

<p>A type is deemed inherently deeply thread-safe if it meets two requirements. The first
requirement is that it meets at least one of these four conditions:

<ul>
  <li>it is listed as a well-known immutable type in <code>
      com.google.errorprone.bugpatterns.threadsafety.WellKnownMutability</code> (e.g. a field of type
      <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link"><code>String</code></a>); and/or
  <li>it is listed as a well-known thread-safe type in <code>
      com.google.errorprone.bugpatterns.threadsafety.WellKnownThreadSafety</code> (e.g. a field of type
      <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/atomic/AtomicBoolean.html" title="class or interface in java.util.concurrent.atomic" class="external-link"><code>AtomicBoolean</code></a>); and/or
  <li>it is annotated with <a href="Immutable.html" title="annotation interface in com.google.errorprone.annotations"><code>Immutable</code></a>; and/or
  <li>it is annotated with <a href="ThreadSafe.html" title="annotation interface in com.google.errorprone.annotations"><code>ThreadSafe</code></a>.
</ul>

<p>This first requirement means the type is at least inherently shallowly thread-safe. For types
with type parameters to be deemed deeply thread-safe, those of these types that denote
containment must also be deemed thread-safe. A full explanation of this can be found in the
<code>ThreadSafeTypeParameter</code> javadoc.

<p>Fields annotated with <code>javax.annotation.concurrent.GuardedBy</code> are likely the meat of a
mutable thread-safe class: these are things that need to be mutated, but should be done so in a
safe manner -- i.e., (most likely) in critical sections of code that protect their access by
means of a lock. See more information in that annotation's javadoc.

<p>As stated before, the heuristics above are not sufficient to guarantee the thread safety of a
class. Also as stated before, thread-safety is tricky, and requires diligent analysis by skilled
people. That said, we provide here a few examples of common examples of ways to break these
heuristics, so as to help you avoid them:

<ul>
  <li>a non-private <code>@GuardedBy</code> field -- i.e.if a non-private <code>@GuardedBy</code> field is
      accessed outside the class, the code that enforces <code>@GuardedBy</code> will not prevent
      unprotected access and/or modifications to the field;
  <li>indirect access to the field. There are several ways in which code may access the objects
      stored in the field indirectly (i.e. not directly referencing the field). In all these
      cases, <code>@GuardedBy</code> offers no enforcement. Here's some examples:
      <ul>
        <li>if the <code>@GuardedBy</code> field instance is part of an object by a method (e.g. a
            simple getter method or constructor parameter);
        <li>if a method takes an out-parameter and the method calls a method in that
            out-parameter passing the instance of the <code>@GuardedBy</code> field, and that instance
            is stored in the out-parameter (i.e. a simple setter method);
      </ul>
  <li>methods that perform multiple operations -- e.g., if a class <code>Foo</code> contains a <code>
      AtomicInteger</code> (which is an inherently deeply thread-safe data structure), the following
      code makes this class not thread-safe:
      <pre><code>private void incrementMyAtomicInteger() {
  myAtomicInteger.set(myAtomicInteger.get() + 1);
}

</code></pre>
</ul>

Also see https://errorprone.info/bugpattern/ThreadSafe</div>
</div>
</section>
<section class="details" id="annotation-interface-element-detail"></section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025 <a href="https://www.google.com">Google LLC</a>. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
